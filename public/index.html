<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Tracker</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-boxes"></i> Inventory Tracker</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="showBulkImportModal()">
                        <i class="fas fa-upload"></i> Bulk Import
                    </button>
                    <button class="btn btn-primary" onclick="showAddProductModal()">
                        <i class="fas fa-plus"></i> Add Product
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav">
            <button class="nav-item active" onclick="showSection('dashboard')">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </button>
            <button class="nav-item" onclick="showSection('products')">
                <i class="fas fa-box"></i>
                <span>Products</span>
            </button>
            <button class="nav-item" onclick="showSection('stock')">
                <i class="fas fa-warehouse"></i>
                <span>Stock</span>
            </button>
            <button class="nav-item" onclick="showSection('movements')">
                <i class="fas fa-exchange-alt"></i>
                <span>Movements</span>
            </button>
            <button class="nav-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalProducts">0</h3>
                            <p>Total Products</p>
                        </div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="lowStockItems">0</h3>
                            <p>Low Stock Items</p>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalItems">0</h3>
                            <p>Total Items</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-content">
                    <div class="card">
                        <h3>Recent Stock Movements</h3>
                        <div id="recentMovements" class="movements-list">
                            <!-- Recent movements will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Products Section -->
            <section id="products" class="section">
                <div class="section-header">
                    <h2>Products</h2>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="productSearch" placeholder="Search products..." onkeyup="filterProducts()">
                    </div>
                </div>
                <div class="products-grid" id="productsGrid">
                    <!-- Products will be loaded here -->
                </div>
            </section>

            <!-- Stock Section -->
            <section id="stock" class="section">
                <div class="section-header">
                    <h2>Stock Management</h2>
                    <button class="btn btn-primary" onclick="showStockAdjustModal()">
                        <i class="fas fa-edit"></i> Adjust Stock
                    </button>
                </div>
                <div class="stock-table-container">
                    <table class="stock-table" id="stockTable">
                        <thead>
                            <tr>
                                <th>SKU</th>
                                <th>Product</th>
                                <th>Current Stock</th>
                                <th>Min Stock</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="stockTableBody">
                            <!-- Stock data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Movements Section -->
            <section id="movements" class="section">
                <div class="section-header">
                    <h2>Stock Movements</h2>
                </div>
                <div class="movements-container">
                    <div id="movementsList" class="movements-list">
                        <!-- Movements will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="section">
                <div class="settings-grid">
                    <div class="card">
                        <h3>Categories</h3>
                        <button class="btn btn-secondary" onclick="showAddCategoryModal()">
                            <i class="fas fa-plus"></i> Add Category
                        </button>
                        <div id="categoriesList" class="list">
                            <!-- Categories will be loaded here -->
                        </div>
                    </div>
                    <div class="card">
                        <h3>Suppliers</h3>
                        <button class="btn btn-secondary" onclick="showAddSupplierModal()">
                            <i class="fas fa-plus"></i> Add Supplier
                        </button>
                        <div id="suppliersList" class="list">
                            <!-- Suppliers will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Product</h3>
                <button class="close" onclick="closeModal('addProductModal')">&times;</button>
            </div>
            <form id="addProductForm" onsubmit="addProduct(event)">
                <div class="form-group">
                    <label for="productSku">SKU *</label>
                    <input type="text" id="productSku" required>
                </div>
                <div class="form-group">
                    <label for="productName">Product Name *</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label for="productDescription">Description</label>
                    <textarea id="productDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="productImageUrl">Image URL</label>
                    <input type="url" id="productImageUrl" placeholder="https://example.com/image.jpg" onchange="previewProductImage()">
                    <div id="imagePreview" class="image-preview"></div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productCategory">Category</label>
                        <select id="productCategory">
                            <option value="">Select Category</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productSupplier">Supplier</label>
                        <select id="productSupplier">
                            <option value="">Select Supplier</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="productMinStock">Min Stock</label>
                        <input type="number" id="productMinStock" min="0" value="0">
                    </div>
                    <div class="form-group">
                        <label for="productMaxStock">Max Stock</label>
                        <input type="number" id="productMaxStock" min="0" value="1000">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addProductModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Stock Adjust Modal -->
    <div id="stockAdjustModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Adjust Stock</h3>
                <button class="close" onclick="closeModal('stockAdjustModal')">&times;</button>
            </div>
            <form id="stockAdjustForm" onsubmit="adjustStock(event)">
                <div class="form-group">
                    <label for="adjustProduct">Product *</label>
                    <select id="adjustProduct" required>
                        <option value="">Select Product</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="adjustmentType">Movement Type *</label>
                    <select id="adjustmentType" required>
                        <option value="IN">Stock In</option>
                        <option value="OUT">Stock Out</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="adjustQuantity">Quantity *</label>
                    <input type="number" id="adjustQuantity" min="1" required>
                </div>
                <div class="form-group">
                    <label for="adjustReference">Reference</label>
                    <input type="text" id="adjustReference" placeholder="PO#, Invoice#, etc.">
                </div>
                <div class="form-group">
                    <label for="adjustNotes">Notes</label>
                    <textarea id="adjustNotes" rows="3" placeholder="Additional notes..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('stockAdjustModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Adjust Stock</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div id="addCategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Category</h3>
                <button class="close" onclick="closeModal('addCategoryModal')">&times;</button>
            </div>
            <form id="addCategoryForm" onsubmit="addCategory(event)">
                <div class="form-group">
                    <label for="categoryName">Category Name *</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label for="categoryDescription">Description</label>
                    <textarea id="categoryDescription" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addCategoryModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Category</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Supplier Modal -->
    <div id="addSupplierModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Supplier</h3>
                <button class="close" onclick="closeModal('addSupplierModal')">&times;</button>
            </div>
            <form id="addSupplierForm" onsubmit="addSupplier(event)">
                <div class="form-group">
                    <label for="supplierName">Supplier Name *</label>
                    <input type="text" id="supplierName" required>
                </div>
                <div class="form-group">
                    <label for="supplierContact">Contact Person</label>
                    <input type="text" id="supplierContact">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="supplierEmail">Email</label>
                        <input type="email" id="supplierEmail">
                    </div>
                    <div class="form-group">
                        <label for="supplierPhone">Phone</label>
                        <input type="tel" id="supplierPhone">
                    </div>
                </div>
                <div class="form-group">
                    <label for="supplierAddress">Address</label>
                    <textarea id="supplierAddress" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addSupplierModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Supplier</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
    </div>

    <!-- Bulk Import Modal -->
    <div id="bulkImportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Bulk Import Products</h3>
                <button class="close" onclick="closeModal('bulkImportModal')">&times;</button>
            </div>
            <div style="padding: 1.5rem;">
                <div class="form-group">
                    <label>Import Method</label>
                    <div class="import-tabs">
                        <button type="button" class="tab-btn active" onclick="switchImportTab('json')">JSON Format</button>
                        <button type="button" class="tab-btn" onclick="switchImportTab('template')">Use Template</button>
                    </div>
                </div>
                
                <div id="jsonImport" class="import-section active">
                    <div class="form-group">
                        <label for="bulkImportData">Paste JSON Data</label>
                        <textarea id="bulkImportData" rows="15" placeholder='[
  {
    "sku": "PROD001",
    "name": "Product Name",
    "description": "Product description",
    "image_url": "https://example.com/image.jpg",
    "category_id": 1,
    "supplier_id": 1,
    "unit_price": 29.99,
    "cost_price": 15.00,
    "min_stock": 5,
    "max_stock": 100,
    "initial_stock": 0
  }
]'></textarea>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-secondary" onclick="generateSataTemplate()">
                            <i class="fas fa-magic"></i> Generate SATA Uganda Template
                        </button>
                        <small class="text-muted">This will generate a template with 279 SATA Uganda products</small>
                    </div>
                </div>
                
                <div id="templateImport" class="import-section">
                    <div class="form-group">
                        <label for="csvFile">Upload CSV File</label>
                        <input type="file" id="csvFile" accept=".csv" onchange="handleCSVUpload(event)">
                        <small class="text-muted">CSV format: sku,name,description,image_url,unit_price,cost_price,min_stock,initial_stock</small>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-secondary" onclick="downloadCSVTemplate()">
                            <i class="fas fa-download"></i> Download CSV Template
                        </button>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('bulkImportModal')">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="processBulkImport()">
                        <i class="fas fa-upload"></i> Import Products
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="app.js"></script>
</body>
</html>